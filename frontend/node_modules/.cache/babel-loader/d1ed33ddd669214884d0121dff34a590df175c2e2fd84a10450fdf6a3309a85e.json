{"ast":null,"code":"import _slicedToArray from\"D:/react-mesto-api-full-gha/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import PopupWithForm from\"../PopupWithForm/PopupWithForm\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditAvatarPopup(props){var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),avatar=_React$useState2[0],setAvatar=_React$useState2[1];var inputRef=React.useRef();var _React$useState3=React.useState({avatarLinkValid:false}),_React$useState4=_slicedToArray(_React$useState3,2),avatarValidity=_React$useState4[0],setAvatarValidity=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),avatarError=_React$useState6[0],setAvatarError=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isFocused=_React$useState8[0],setIsFocused=_React$useState8[1];React.useEffect(function(){setAvatar('');},[props.isOpen]);React.useEffect(function(){var httpRegex=/^https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)$/;var avatarValid=avatar!==undefined&&httpRegex.test(avatar);setAvatarError(function(){if(!isFocused){setAvatarError('');}else if(avatar===''){return'Введите ссылку на картинку';}else if(avatar!==''&&!avatarValid){return'Введена некорректная ссылка';}});setAvatarValidity(function(){return{avatarLinkValid:avatarValid};});},[avatar,setAvatarValidity,setIsFocused]);var handleSubmit=function handleSubmit(e){e.preventDefault();props.onUpdateAvatar({avatar:inputRef.current.value});};var handleAvatarChange=function handleAvatarChange(e){setAvatar(e.target.value);};function handleFocus(){setIsFocused(true);}function handleBlur(){setIsFocused(false);}return/*#__PURE__*/_jsx(PopupWithForm,{name:\"form-avatar\",title:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0430\\u0432\\u0430\\u0442\\u0430\\u0440\",textButton:props.isLoading?'Сохранение...':'Сохранить',isOpen:props.isOpen,onClose:props.onClose,handleSubmit:handleSubmit,isFormValid:avatarValidity.avatarLinkValid,children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"popup__input-avatar-pictire\",children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,onChange:handleAvatarChange,onFocus:handleFocus,onBlur:handleBlur,className:\"popup__input popup__input_type_avatar \".concat(!avatarValidity.avatarLinkValid&&isFocused&&'popup__input_type_error'),id:\"popup__input-avatar-pictire\",minLength:\"2\",name:\"avatar\",type:\"text\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0441\\u044B\\u043B\\u043A\\u0443\",value:''||avatar,required:true}),/*#__PURE__*/_jsx(\"span\",{className:\"popup__input-error popup__input-avatar-pictire-error \".concat(!avatarValidity.avatarLinkValid&&'popup__input-error_active'),children:avatarError})]})});}export default EditAvatarPopup;","map":{"version":3,"names":["React","PopupWithForm","jsx","_jsx","jsxs","_jsxs","EditAvatarPopup","props","_React$useState","useState","_React$useState2","_slicedToArray","avatar","setAvatar","inputRef","useRef","_React$useState3","avatarLinkValid","_React$useState4","avatarValidity","setAvatarValidity","_React$useState5","_React$useState6","avatarError","setAvatarError","_React$useState7","_React$useState8","isFocused","setIsFocused","useEffect","isOpen","httpRegex","avatarValid","undefined","test","handleSubmit","e","preventDefault","onUpdateAvatar","current","value","handleAvatarChange","target","handleFocus","handleBlur","name","title","textButton","isLoading","onClose","isFormValid","children","htmlFor","ref","onChange","onFocus","onBlur","className","concat","id","minLength","type","placeholder","required"],"sources":["D:/react-mesto-api-full-gha/frontend/src/components/EditAvatarPopup/EditAvatarPopup.js"],"sourcesContent":["import React from \"react\";\r\nimport PopupWithForm from \"../PopupWithForm/PopupWithForm\";\r\n\r\nfunction EditAvatarPopup (props) {\r\n\r\n    const [avatar, setAvatar] = React.useState('');\r\n    const inputRef = React.useRef();\r\n    const [avatarValidity, setAvatarValidity] = React.useState({\r\n        avatarLinkValid: false\r\n    });\r\n    const [avatarError, setAvatarError] = React.useState('');\r\n    const [isFocused, setIsFocused] = React.useState(false);\r\n\r\n    React.useEffect(() => {\r\n        setAvatar('');\r\n    }, [props.isOpen])\r\n\r\n    React.useEffect(() => {\r\n        const httpRegex = /^https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)$/;\r\n        const avatarValid = avatar !== undefined && httpRegex.test(avatar);\r\n\r\n        setAvatarError(() => {\r\n            if (!isFocused) {\r\n                setAvatarError('')\r\n            } else if (avatar === '') {\r\n                return 'Введите ссылку на картинку'\r\n            } else if (avatar !== '' && !avatarValid) {\r\n                return 'Введена некорректная ссылка'\r\n            }\r\n        })\r\n\r\n        setAvatarValidity(() => ({\r\n            avatarLinkValid: avatarValid\r\n        }))\r\n    }, [avatar, setAvatarValidity, setIsFocused])\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n\r\n        props.onUpdateAvatar({\r\n            avatar: inputRef.current.value\r\n        })\r\n\r\n    }\r\n\r\n    const handleAvatarChange = (e) => {\r\n        setAvatar(e.target.value);\r\n    }\r\n\r\n    function handleFocus () {\r\n        setIsFocused(true);\r\n    }\r\n\r\n    function handleBlur () {\r\n        setIsFocused(false);\r\n    }\r\n\r\n    return (\r\n        <PopupWithForm name='form-avatar' title='Обновить аватар' textButton={props.isLoading ? 'Сохранение...' : 'Сохранить'} \r\n            isOpen={props.isOpen} onClose={props.onClose} handleSubmit={handleSubmit} isFormValid={avatarValidity.avatarLinkValid}>\r\n                        <label htmlFor=\"popup__input-avatar-pictire\">\r\n                            <input \r\n                            ref={inputRef}\r\n                            onChange={handleAvatarChange}\r\n                            onFocus={handleFocus}\r\n                            onBlur={handleBlur} \r\n                            className={`popup__input popup__input_type_avatar ${!avatarValidity.avatarLinkValid && isFocused && 'popup__input_type_error'}`} \r\n                            id=\"popup__input-avatar-pictire\" \r\n                            minLength=\"2\" name=\"avatar\" \r\n                            type=\"text\" placeholder=\"Введите ссылку\" \r\n                            value={'' || avatar} \r\n                            required />\r\n                            <span className={`popup__input-error popup__input-avatar-pictire-error ${!avatarValidity.avatarLinkValid && 'popup__input-error_active'}`}>{avatarError}</span>\r\n                        </label>\r\n        </PopupWithForm>\r\n    )\r\n}\r\n\r\nexport default EditAvatarPopup;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}